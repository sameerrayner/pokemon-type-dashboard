import pandas as pd
import sqlite3
import plotly.express as px
import plotly.graph_objects as go
from plotly.subplots import make_subplots

conn = sqlite3.connect('pkmn_types_stats.db')

type_avg_df2 = pd.read_sql("SELECT 'Normal' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Normal' IN (Type1, Type2) UNION SELECT 'Grass' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Grass' IN (Type1, Type2) UNION SELECT 'Water' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Water' IN (Type1, Type2) UNION SELECT 'Fire' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Fire' IN (Type1, Type2) UNION SELECT 'Flying' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Flying' IN (Type1, Type2) UNION SELECT 'Fighting' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Fighting' IN (Type1, Type2) UNION SELECT 'Bug' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Bug' IN (Type1, Type2) UNION SELECT 'Electric' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Electric' IN (Type1, Type2) UNION SELECT 'Ground' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Ground' IN (Type1, Type2) UNION SELECT 'Rock' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Rock' IN (Type1, Type2) UNION SELECT 'Ice' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Ice' IN (Type1, Type2) UNION SELECT 'Poison' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Poison' IN (Type1, Type2) UNION SELECT 'Psychic' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Psychic' IN (Type1, Type2) UNION SELECT 'Ghost' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Ghost' IN (Type1, Type2) UNION SELECT 'Dragon' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Dragon' IN (Type1, Type2) UNION SELECT 'Dark' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Dark' IN (Type1, Type2) UNION SELECT 'Steel' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Steel' IN (Type1, Type2) UNION SELECT 'Fairy' as Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data WHERE 'Fairy' IN (Type1, Type2) UNION SELECT 'Overall' AS Type, AVG(HP), AVG(Attack), AVG(Defence), AVG(`Special Attack`), AVG(`Special Defence`), AVG(`Speed`), AVG(Total) FROM data;", conn)

tad2 = pd.melt(type_avg_df2.drop('AVG(Total)', axis = 1), id_vars='Type', value_name = 'Average')
tad2.variable = tad2.variable.str.replace('AVG(', '')
tad2.variable = tad2.variable.str.replace('`', '')
tad2.variable = tad2.variable.str.replace(')', '')
tad2.variable = tad2.variable.str.replace('Defence', 'Defense')

tad2.variable = pd.Categorical(tad2.variable, categories=['HP', 'Attack', 'Defense', 'Speed', 'Special Defense', 'Special Attack'], ordered = True)
tad2.sort_values('variable', inplace = True)

maxdf = pd.read_sql("SELECT 'Normal' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Normal' IN (Type1, Type2) UNION SELECT 'Normal' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Normal' IN (Type1, Type2) UNION SELECT 'Normal' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Normal' IN (Type1, Type2) UNION SELECT 'Normal' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Normal' IN (Type1, Type2) UNION SELECT 'Normal' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Normal' IN (Type1, Type2) UNION SELECT 'Normal' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Normal' IN (Type1, Type2) UNION SELECT 'Normal' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Normal' IN (Type1, Type2) UNION SELECT 'Fire' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Fire' IN (Type1, Type2) UNION SELECT 'Fire' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Fire' IN (Type1, Type2) UNION SELECT 'Fire' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Fire' IN (Type1, Type2) UNION SELECT 'Fire' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Fire' IN (Type1, Type2) UNION SELECT 'Fire' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Fire' IN (Type1, Type2) UNION SELECT 'Fire' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Fire' IN (Type1, Type2) UNION SELECT 'Fire' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Fire' IN (Type1, Type2) UNION SELECT 'Water' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Water' IN (Type1, Type2) UNION SELECT 'Water' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Water' IN (Type1, Type2) UNION SELECT 'Water' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Water' IN (Type1, Type2) UNION SELECT 'Water' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Water' IN (Type1, Type2) UNION SELECT 'Water' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Water' IN (Type1, Type2) UNION SELECT 'Water' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Water' IN (Type1, Type2) UNION SELECT 'Water' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Water' IN (Type1, Type2) UNION SELECT 'Grass' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Grass' IN (Type1, Type2) UNION SELECT 'Grass' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Grass' IN (Type1, Type2) UNION SELECT 'Grass' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Grass' IN (Type1, Type2) UNION SELECT 'Grass' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Grass' IN (Type1, Type2) UNION SELECT 'Grass' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Grass' IN (Type1, Type2) UNION SELECT 'Grass' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Grass' IN (Type1, Type2) UNION SELECT 'Grass' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Grass' IN (Type1, Type2) UNION SELECT 'Electric' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Electric' IN (Type1, Type2) UNION SELECT 'Electric' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Electric' IN (Type1, Type2) UNION SELECT 'Electric' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Electric' IN (Type1, Type2) UNION SELECT 'Electric' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Electric' IN (Type1, Type2) UNION SELECT 'Electric' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Electric' IN (Type1, Type2) UNION SELECT 'Electric' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Electric' IN (Type1, Type2) UNION SELECT 'Electric' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Electric' IN (Type1, Type2) UNION SELECT 'Ice' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Ice' IN (Type1, Type2) UNION SELECT 'Ice' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Ice' IN (Type1, Type2) UNION SELECT 'Ice' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Ice' IN (Type1, Type2) UNION SELECT 'Ice' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Ice' IN (Type1, Type2) UNION SELECT 'Ice' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Ice' IN (Type1, Type2) UNION SELECT 'Ice' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Ice' IN (Type1, Type2) UNION SELECT 'Ice' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Ice' IN (Type1, Type2) UNION SELECT 'Fighting' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Fighting' IN (Type1, Type2) UNION SELECT 'Fighting' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Fighting' IN (Type1, Type2) UNION SELECT 'Fighting' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Fighting' IN (Type1, Type2) UNION SELECT 'Fighting' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Fighting' IN (Type1, Type2) UNION SELECT 'Fighting' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Fighting' IN (Type1, Type2) UNION SELECT 'Fighting' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Fighting' IN (Type1, Type2) UNION SELECT 'Fighting' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Fighting' IN (Type1, Type2) UNION SELECT 'Poison' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Poison' IN (Type1, Type2) UNION SELECT 'Poison' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Poison' IN (Type1, Type2) UNION SELECT 'Poison' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Poison' IN (Type1, Type2) UNION SELECT 'Poison' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Poison' IN (Type1, Type2) UNION SELECT 'Poison' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Poison' IN (Type1, Type2) UNION SELECT 'Poison' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Poison' IN (Type1, Type2) UNION SELECT 'Poison' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Poison' IN (Type1, Type2) UNION SELECT 'Ground' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Ground' IN (Type1, Type2) UNION SELECT 'Ground' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Ground' IN (Type1, Type2) UNION SELECT 'Ground' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Ground' IN (Type1, Type2) UNION SELECT 'Ground' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Ground' IN (Type1, Type2) UNION SELECT 'Ground' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Ground' IN (Type1, Type2) UNION SELECT 'Ground' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Ground' IN (Type1, Type2) UNION SELECT 'Ground' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Ground' IN (Type1, Type2) UNION SELECT 'Flying' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Flying' IN (Type1, Type2) UNION SELECT 'Flying' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Flying' IN (Type1, Type2) UNION SELECT 'Flying' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Flying' IN (Type1, Type2) UNION SELECT 'Flying' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Flying' IN (Type1, Type2) UNION SELECT 'Flying' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Flying' IN (Type1, Type2) UNION SELECT 'Flying' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Flying' IN (Type1, Type2) UNION SELECT 'Flying' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Flying' IN (Type1, Type2) UNION SELECT 'Psychic' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Psychic' IN (Type1, Type2) UNION SELECT 'Psychic' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Psychic' IN (Type1, Type2) UNION SELECT 'Psychic' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Psychic' IN (Type1, Type2) UNION SELECT 'Psychic' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Psychic' IN (Type1, Type2) UNION SELECT 'Psychic' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Psychic' IN (Type1, Type2) UNION SELECT 'Psychic' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Psychic' IN (Type1, Type2) UNION SELECT 'Psychic' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Psychic' IN (Type1, Type2) UNION SELECT 'Bug' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Bug' IN (Type1, Type2) UNION SELECT 'Bug' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Bug' IN (Type1, Type2) UNION SELECT 'Bug' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Bug' IN (Type1, Type2) UNION SELECT 'Bug' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Bug' IN (Type1, Type2) UNION SELECT 'Bug' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Bug' IN (Type1, Type2) UNION SELECT 'Bug' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Bug' IN (Type1, Type2) UNION SELECT 'Bug' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Bug' IN (Type1, Type2) UNION SELECT 'Rock' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Rock' IN (Type1, Type2) UNION SELECT 'Rock' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Rock' IN (Type1, Type2) UNION SELECT 'Rock' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Rock' IN (Type1, Type2) UNION SELECT 'Rock' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Rock' IN (Type1, Type2) UNION SELECT 'Rock' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Rock' IN (Type1, Type2) UNION SELECT 'Rock' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Rock' IN (Type1, Type2) UNION SELECT 'Rock' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Rock' IN (Type1, Type2) UNION SELECT 'Ghost' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Ghost' IN (Type1, Type2) UNION SELECT 'Ghost' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Ghost' IN (Type1, Type2) UNION SELECT 'Ghost' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Ghost' IN (Type1, Type2) UNION SELECT 'Ghost' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Ghost' IN (Type1, Type2) UNION SELECT 'Ghost' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Ghost' IN (Type1, Type2) UNION SELECT 'Ghost' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Ghost' IN (Type1, Type2) UNION SELECT 'Ghost' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Ghost' IN (Type1, Type2) UNION SELECT 'Dragon' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Dragon' IN (Type1, Type2) UNION SELECT 'Dragon' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Dragon' IN (Type1, Type2) UNION SELECT 'Dragon' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Dragon' IN (Type1, Type2) UNION SELECT 'Dragon' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Dragon' IN (Type1, Type2) UNION SELECT 'Dragon' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Dragon' IN (Type1, Type2) UNION SELECT 'Dragon' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Dragon' IN (Type1, Type2) UNION SELECT 'Dragon' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Dragon' IN (Type1, Type2) UNION SELECT 'Dark' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Dark' IN (Type1, Type2) UNION SELECT 'Dark' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Dark' IN (Type1, Type2) UNION SELECT 'Dark' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Dark' IN (Type1, Type2) UNION SELECT 'Dark' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Dark' IN (Type1, Type2) UNION SELECT 'Dark' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Dark' IN (Type1, Type2) UNION SELECT 'Dark' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Dark' IN (Type1, Type2) UNION SELECT 'Dark' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Dark' IN (Type1, Type2) UNION SELECT 'Steel' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Steel' IN (Type1, Type2) UNION SELECT 'Steel' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Steel' IN (Type1, Type2) UNION SELECT 'Steel' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Steel' IN (Type1, Type2) UNION SELECT 'Steel' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Steel' IN (Type1, Type2) UNION SELECT 'Steel' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Steel' IN (Type1, Type2) UNION SELECT 'Steel' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Steel' IN (Type1, Type2) UNION SELECT 'Steel' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Steel' IN (Type1, Type2) UNION SELECT 'Fairy' AS Type, 'Total' AS Stat, Name, MAX(Total) AS Max_Value FROM data WHERE 'Fairy' IN (Type1, Type2) UNION SELECT 'Fairy' AS Type, 'HP' AS Stat, Name, MAX(HP) AS Max_Value FROM data WHERE 'Fairy' IN (Type1, Type2) UNION SELECT 'Fairy' AS Type, 'Attack' AS Stat, Name, MAX(Attack) AS Max_Value FROM data WHERE 'Fairy' IN (Type1, Type2) UNION SELECT 'Fairy' AS Type, 'Defense' AS Stat, Name, MAX(Defence) AS Max_Value FROM data WHERE 'Fairy' IN (Type1, Type2) UNION SELECT 'Fairy' AS Type, 'Speed' AS Stat, Name, MAX(Speed) AS Max_Value FROM data WHERE 'Fairy' IN (Type1, Type2) UNION SELECT 'Fairy' AS Type, 'Special Defense' AS Stat, Name, MAX(`Special Defence`) AS Max_Value FROM data WHERE 'Fairy' IN (Type1, Type2) UNION SELECT 'Fairy' AS Type, 'Special Attack' AS Stat, Name, MAX(`Special Attack`) AS Max_Value FROM data WHERE 'Fairy' IN (Type1, Type2);", conn)

conn.close()

tad2 = tad2[tad2.Type != 'Overall']

fig = make_subplots(rows = 3, cols = 3, 
                    specs = [[{'type':'polar', 'rowspan':3}, {'type':'indicator'}, {'type':'indicator'}], 
                             [{'l' : 0}, {'type':'indicator'}, {'type':'indicator'}], 
                             [{'l' : 0}, {'type':'indicator'}, {'type':'indicator'}]],
                    column_widths = [0.5,0.25,0.25]
                   )

for t in tad2['Type'].unique():
    dummy = tad2[tad2['Type'] == t]
    fig.add_trace(go.Scatterpolar(r= dummy['Average'], theta= dummy['variable'], name = t, visible = 'legendonly', showlegend = False), row = 1, col = 1)

for t in tad2['Type'].unique():
    dummy2 = maxdf[maxdf['Type'] == t]
    fig.add_trace(go.Indicator(mode = 'number+gauge', 
                               value = dummy2.loc[dummy2.Stat == 'HP', 'Max_Value'].item(), title = f'Highest HP: {dummy2.loc[dummy2.Stat == 'HP', 'Name'].item()}'), 
                  row = 1, col = 2)

for t in tad2['Type'].unique():
    dummy2 = maxdf[maxdf['Type'] == t]
    fig.add_trace(go.Indicator(mode = 'number+gauge', 
                               value = dummy2.loc[dummy2.Stat == 'Speed', 'Max_Value'].item(), title = f'Highest Speed: {dummy2.loc[dummy2.Stat == 'Speed', 'Name'].item()}'), 
                  row = 1, col = 3)

for t in tad2['Type'].unique():
    dummy2 = maxdf[maxdf['Type'] == t]
    fig.add_trace(go.Indicator(mode = 'number+gauge', 
                               value = dummy2.loc[dummy2.Stat == 'Attack', 'Max_Value'].item(), title = f'Highest Attack: {dummy2.loc[dummy2.Stat == 'Attack', 'Name'].item()}'), 
                  row = 2, col = 2)

for t in tad2['Type'].unique():
    dummy2 = maxdf[maxdf['Type'] == t]
    fig.add_trace(go.Indicator(mode = 'number+gauge', 
                               value = dummy2.loc[dummy2.Stat == 'Special Attack', 'Max_Value'].item(), title = f'Highest Special Attack: {dummy2.loc[dummy2.Stat == 'Special Attack', 'Name'].item()}'), 
                  row = 2, col = 3)

for t in tad2['Type'].unique():
    dummy2 = maxdf[maxdf['Type'] == t]
    fig.add_trace(go.Indicator(mode = 'number+gauge', 
                               value = dummy2.loc[dummy2.Stat == 'Defense', 'Max_Value'].item(), title = f'Highest Defense: {dummy2.loc[dummy2.Stat == 'Defense', 'Name'].item()}'), 
                  row = 3, col = 2)

for t in tad2['Type'].unique():
    dummy2 = maxdf[maxdf['Type'] == t]
    fig.add_trace(go.Indicator(mode = 'number+gauge', 
                               value = dummy2.loc[dummy2.Stat == 'Special Defense', 'Max_Value'].item(), title = f'Highest Special Defense: {dummy2.loc[dummy2.Stat == 'Special Defense', 'Name'].item()}'), 
                  row = 3, col = 3)


dropdown_buttons = []

for t in tad2['Type'].unique():
    dummy_bool = [False] * len(tad2['Type'].unique())
    dummy_bool[list(tad2['Type'].unique()).index(t)] = True
    dummy = {'label': t, 'method': 'update', 'args': [
        {'visible': dummy_bool},
        {'title': f'Pokemon Stats: {t} Type'}
    ]}
    dropdown_buttons.append(dummy)

fig.update_layout({'updatemenus': [
    {'type': 'buttons',
        'direction': 'right',
        'xanchor': 'left',
        'y': 1.25,
        'showactive': True,
        'active': -1,
        'bgcolor': 'white',
        'buttons': dropdown_buttons}
]})

fig.update_traces(fill='toself', hovertemplate = 'Average %{theta}: %{r:.1f}', mode = 'markers', 
                  selector = dict(type = 'scatterpolar'))

fig.update_traces(gauge = {'axis': {'visible' : False, 'range' : [None, maxdf.loc[maxdf.Stat != 'Total', 'Max_Value'].max()]},
                                       'steps': [
                                           {'range': [0, (maxdf.loc[maxdf.Stat != 'Total', 'Max_Value'].max())/3], 'color': '#fed8d7'},
                                           {'range': [(maxdf.loc[maxdf.Stat != 'Total', 'Max_Value'].max())/3, (maxdf.loc[maxdf.Stat != 'Total', 'Max_Value'].max())/3*2], 'color': '#faf6aa'},
                                           {'range': [(maxdf.loc[maxdf.Stat != 'Total', 'Max_Value'].max())/3*2, (maxdf.loc[maxdf.Stat != 'Total', 'Max_Value'].max())], 'color': '#bdffc5'}]},
                  title_font_size = 15,
                  number_font_size = 55,
                  gauge_bar_color = '#028e00',
                  visible = 'legendonly', 
                  selector = dict(type = 'indicator'))

fig.update_layout(hoverlabel = dict(bgcolor = '#e1ccbe'), autosize = False, width = 1200, height = 700, paper_bgcolor = '#e1ccbe',
                  title = 'Click on any type to explore',
                polar = dict(
                            radialaxis = dict(showticklabels=False, ticks ='', linewidth = 0, visible = False, range = [0,110]),
                            angularaxis = dict(direction = 'clockwise')))

fig.write_html("pkmn_type_dash.html")